{
    "contents" : "---\ntitle: \"Marketing Mix Modeling Explained - with R\"\nauthor: \"Gabriel Mohanna\"\ndate: \"Tuesday, August 17, 2014\"\noutput: html_document\n---\n\nMarketing mix modeling (MMM) is a process used to quantify the effects of different advertising mediums, i.e. media. It is also used to optimize spend budget over these different mediums. The popular method of choice is multiple regression analysis. The model also takes into account other variables such as pricing, distribution points and competitor tactics. This article will explain the mathematics behind MMM by starting with a simple model then adding complexities. I'll also incorporate R code so you can immediately reproduce the results.\n\n**Start Simple:**</br>\nLet's assume there is only one advertising variable that affects sales. This simple model is usually defined as:\n\n$$\n\\text{Sales} = \\text{Base} + b_1\\!\\cdot\\!\\text{Advertising}\n$$\n\nThere are two aspect to this model: (1) It is linear and (2) $\\text{Base}$ is a constant. This is OK for now as we'll add more complexity later. However, I can quickly tell you that $\\text{Base}$ can include other variables to make it non-constant. The non-linearity part will be introduced in a future blog post.\n\nA sample R code can be:\n```{r eval=F, echo=F}\nset.seed(3599)\na <- pmax(runif(20, -20, 30), 0)\nb <- pmax(runif(20, -20, 20), 0)\ny <- 10 + \n    2.32 * as.numeric(filter(a, .72, method=\"recursive\")) +\n    4.00 * as.numeric(filter(b, .42, method=\"recursive\")) +\n    0.80 * 1:20\npaste(round(y, 0), collapse=\", \")\npaste(round(a, 0), collapse=\", \")\npaste(round(b, 0), collapse=\", \")\n```\n```{r tidy=F, results='hide'}\nsales <- c(37, 89, 82, 58, 110, 77, 103, 78, 95, 106, 98, 96, 68, 96, 157, 198, 145, 132, 96, 135)\nad <- c(6, 27, 0, 0, 20, 0, 20, 0, 0, 18, 9, 0, 0, 0, 13, 25, 0, 15, 0, 0)\n\nmodFit.0 <- lm(sales~ad)\nsummary(modFit.0)\n```\n\nThis model has an $R^2$ of `r round(summary(modFit.0)$r.squared, 3)` so there is much work to be done.\n\n**Complexity 1: The Adstock Case**</br>\nThe model above assumes that advertising in week $t$ will only affect sales that same week. This is wrong and will cause the advertising effect to be under-valued. Simply put, past ads can (and usually do) affect present and future sales. This multi effect aspect of advertising can be controlled for with [adstock transformation](http://analyticsartist.wordpress.com/2013/11/02/calculating-adstock-effect/), which I covered in a previous blog post.\n\nOur model now becomes:\n\n$$\n\\text{Sales} = \\text{Base} + b_1\\!\\cdot\\!f_{\\alpha}(\\text{Advertising})\n$$\n\nwhere $f_{\\alpha}$ is a the adstock transformation function for $\\text{Advertising}$ with an adstock of $\\alpha$. Other functional forms besides adstock can be incorporated here as well.\n\nWith an adstock rate of 50% the R code is:\n```{r tidy=F, results='hide'}\nsales <- c(37, 89, 82, 58, 110, 77, 103, 78, 95, 106, 98, 96, 68, 96, 157, 198, 145, 132, 96, 135)\nad <- c(6, 27, 0, 0, 20, 0, 20, 0, 0, 18, 9, 0, 0, 0, 13, 25, 0, 15, 0, 0)\n\nad.adstock <- as.numeric(filter(x=ad, filter=.50, method=\"recursive\"))\n\nmodFit.1 <- lm(sales~ad.adstock)\nsummary(modFit.1)\n```\n\nNotice how we improved $R^2$ from `r round(summary(modFit.0)$r.squared, 3)` to `r round(summary(modFit.1)$r.squared, 3)`.\n\n**Complexity 2: More Advertising Variables**</br>\nIt should be clear by now that I have been using advertising mediums and advertising variables interchangeability. From modeling prospective $\\text{Advertising}$ can be a paid media channel like TV, radio or banner ads, a non-paid media variable like social impressions or word-of-mouth, or a marketing campaign. When adding more variables, however, their unit of measure need not be the same. Many measures can be used including TRPs, GRPs, impressions or spend. I listed them in order of preference when available. Regardless of unit of measure in a statistical model they are all called advertising variables and our model formulation becomes:\n\n$$\n\\text{Sales} = \\text{Base} + \\sum_{i=1} b_i\\!\\cdot\\!f_{\\alpha|i}(\\text{Advertising}_i)\n$$\n\nwhere $f_{\\alpha|i}$ is a the adstock transformation function for $\\text{Advertising}_i$ with an adstock of $\\alpha$.\n\nThe R code for two advertising variables with adstock rates of 30% is:\n```{r tidy=F, results='hide'}\nsales <- c(37, 89, 82, 58, 110, 77, 103, 78, 95, 106, 98, 96, 68, 96, 157, 198, 145, 132, 96, 135)\nad1 <- c(6, 27, 0, 0, 20, 0, 20, 0, 0, 18, 9, 0, 0, 0, 13, 25, 0, 15, 0, 0)\nad2 <- c(3, 0, 4, 0, 5, 0, 0, 0, 8, 0, 0, 5, 0, 11, 16, 11, 5, 0, 0, 15)\n\nad1.adstock <- as.numeric(filter(x=ad1, filter=.3, method=\"recursive\"))\nad2.adstock <- as.numeric(filter(x=ad2, filter=.3, method=\"recursive\"))\n\nmodFit.2 <- lm(sales~ad1.adstock+ad2.adstock)\nsummary(modFit.2)\n```\n\nNow, our model is even stronger with $R^2$ of `r round(summary(modFit.2)$r.squared, 3)`.\n\n**Complexity 3: Changing Base & Other Variables**</br>\nSo far we assumed the $\\text{Base}$ to be a constant, i.e. an intercept. I often get asked the question of how to make the $\\text{Base}$ non-constant. The simple answer is $\\text{Base}$ includes more than just the intercept. If you notice an increasing trend in $\\text{Sales}$ then part of modeling is to create a trend variable. This trend variable gets added to the base. Seasonal variables also sometimes get added to the $\\text{Base}$. Finally, there is the idea of distribution points.\n\nDistribution points accounts for the number of outlets (stores or online) that the product in question is being sold at. If a retailer, for example, doubles their stores then we would assume their sales would increase not due to marketing but simply to number of stores available. Marketing plays a role, of course, but I think you get the point.\n\nFinally, pricing & promotions are of prime importance. They too are variables to add to the model. However, these variables aren't part of the base. Due to their complexity I'll leave their discussion to a future blog post.\n\nHence, our current model is now of the form:\n\n$$\n\\text{Sales} = a_0 + a_1\\!\\cdot\\!\\text{Trend} + a_2\\!\\cdot\\!\\text{Distribution} + \\sum_{i=1}\\!b_i\\!\\cdot\\!f_{\\alpha|i}(\\text{Advertising}_i)\n$$\n\n```{r tidy=F, results='hide'}\nsales <- c(37, 89, 82, 58, 110, 77, 103, 78, 95, 106, 98, 96, 68, 96, 157, 198, 145, 132, 96, 135)\nad1 <- c(6, 27, 0, 0, 20, 0, 20, 0, 0, 18, 9, 0, 0, 0, 13, 25, 0, 15, 0, 0)\nad2 <- c(3, 0, 4, 0, 5, 0, 0, 0, 8, 0, 0, 5, 0, 11, 16, 11, 5, 0, 0, 15)\ntrend <- 1:20\n\nad1.adstock <- as.numeric(filter(x=ad1, filter=.3, method=\"recursive\"))\nad2.adstock <- as.numeric(filter(x=ad2, filter=.3, method=\"recursive\"))\n\nmodFit.3 <- lm(sales~trend+ad1.adstock+ad2.adstock)\nsummary(modFit.3)\n```\n\nOur final model's $R^2$ is `r round(summary(modFit.3)$r.squared, 3)`.\n\n**Business Implecations & Contributions**</br>\nAside from the statistical fit of our model clients always ask about the business implication. This is usually referred to as sales lift or uplift due to marketing. a.k.a. the contribution. The contribution in our model is the product of adstocked advertising & the it's coefficient.\n\n$$\n\\text{Contribution}_i = b_i\\!\\cdot\\!f_{\\alpha|i}(\\text{Advertising}_i)\n$$\n\n**Final Remarks & a Challange:**</br>\nYou can see now that Marketing Mix Modeling is a business term for regression analysis on transformed variables. Any decent data scientist or statistition can do the job. However, it is important to note that the mix in Marketing Mix refers to the different mediums, media, campaigns or variables and their effects on sales. This is in contrast to mixed effects models, which measure the effect of one variable on many different levels, like DMA level modeling as an example. Mixed effect models can be used instead of multiple regression analysis when dealing with multiple geographies, like DMA's, but the mixed terms refer to different things and I thought to call out.\n\nThe challenge that faces all statistical analyses is [data as it is 80% of the work](http://blog.revolutionanalytics.com/2014/08/data-cleaning-is-a-critical-part-of-the-data-science-process.html). While that can be taken care of by data personnel, there is still one challenge that escapes many. What adstock rate to give to each advertising variable? This is harder than it sounds and it goes beyond basic statistics. Modelers don't only have to worry about a particular adstock being statistically valid, but they also have to choose among different adstock rates with different contributions, and all of which are statistically valid as well. One reason for this is that the ultimate consumer MMM results is a human. The model that makes the \"most sense\" - however that is defined - can trump the most accurate model. [HBR has a good article](http://blogs.hbr.org/2014/08/the-question-to-ask-before-hiring-a-data-scientist/) about this problem. My recommendation for such scenarios is to track the model's fit statistics at each decision points in the modeling process. The modeler or data scientist can then show the decision maker that choosing a higher contribution will make $R^2$ drop from 90% to 70% and leave the final decision to the business users.",
    "created" : 1414796592725.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3553811887",
    "id" : "B6142D89",
    "lastKnownWriteTime" : 1408642703,
    "path" : "~/OneDrive/Work Files/R Libraries/Marketing Mix Modeling Explained/Marketing Mix Modeling Explained.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}